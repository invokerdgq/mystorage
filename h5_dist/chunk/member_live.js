(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{"372":function(e,t,a){"use strict";a.d(t,"a",function(){return s});var n,o,i=a(3),l=a(4),r=a(905),c=(a(387),function(){function defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}());var s=(o=n=function(e){function OwnOpacity(e){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,OwnOpacity),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(OwnOpacity.__proto__||Object.getPrototypeOf(OwnOpacity)).call(this,e))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(OwnOpacity,l["a"].Component),c(OwnOpacity,[{"key":"render","value":function render(){var e=this.props,t=(e.containerClass,e.containerStyle);return i.l.createElement(r.a,{"className":"more"},i.l.createElement(r.a,{"className":"contain-class","style":t},i.l.createElement(r.a,{"className":"own-hidden"},this.props.renderHide)),i.l.createElement(r.a,{"className":"true-content true-class"},this.props.renderTrue))}}]),OwnOpacity}(),n.options={"addGlobalClass":!0},n.defaultProps={"containerClass":"","containerStyle":null},n.externalClasses=["true-class","contain-class"],o)},"387":function(e,t,a){},"771":function(e,t,a){},"943":function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return g});var n=a(3),o=a(5),i=a(4),l=a(358),r=a(553),c=a(359),s=a(552),u=a(905),f=a(475),m=a(904),p=a(459),h=a(460),v=a(9),b=(a(771),a(372)),d=function(){function defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),y=function get(e,t,a){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:get(o,t,a)}if("value"in n)return n.value;var i=n.get;return void 0!==i?i.call(a):void 0};function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function step(n,o){try{var i=t[n](o),l=i.value}catch(e){return void a(e)}if(!i.done)return Promise.resolve(l).then(function(e){step("next",e)},function(e){step("throw",e)});e(l)}("next")})}}var g=function(e){function Live(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Live);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Live.__proto__||Object.getPrototypeOf(Live)).call(this,e));return t.state={"top":40,"preViewUrl":"","configType":"","showConfig":!1,"face_url":"","name":"","devicePosition":"front","beautify":0,"beautifyList":[0,1,2,3,4,5,6,7,8,9],"filterList":[{"value":"standard","label":"标准"},{"value":"pink","label":"粉嫩"},{"value":"nostalgia","label":"怀旧"},{"value":"blues","label":"蓝调"},{"value":"romantic","label":"浪漫"},{"value":"cool","label":"清凉"},{"value":"fresher","label":"清新"},{"value":"solor","label":"日系"},{"value":"aestheticism","label":"唯美"},{"value":"whitening","label":"美白"},{"value":"cerisered","label":"樱红"}],"filter":"standard","products":[]},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Live,i["a"].Component),d(Live,[{"key":"componentDidMount","value":function componentDidMount(){var e=Object(o.b)("top");this.setState({"top":e}),this.fetchConfig()}},{"key":"fetchConfig","value":function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var e,t,a;return regeneratorRuntime.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,v.a.live.getConfig();case 3:e=n.sent,t=e.GroupInfo,a=e.product,this.setState({"name":t[0].Name,"face_url":t[0].FaceUrl,"preViewUrl":t[0].FaceUrl}),Object(o.f)("chooseList",JSON.parse(a)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),console.log(n.t0);case 13:case"end":return n.stop()}},_callee,this,[[0,10]])}));return function fetchConfig(){return e.apply(this,arguments)}}()},{"key":"back","value":function back(){i.a.navigateBack()}},{"key":"navigateToProgram","value":function navigateToProgram(e){Object(l.j)({"appId":"wx52f496cdcad08ffe","path":"/others/pages/live/live","extraData":{"token":Object(o.b)("auth_token"),"owner":1,"devicePosition":this.state.devicePosition,"beautify":this.state.beautify,"filter":this.state.filter,"im_id":e},"envVersion":"develop","success":function success(){console.log("跳转 苏心购")}})}},{"key":"changeName","value":function changeName(e){this.setState({"name":e.detail.value})}},{"key":"changeCover","value":function changeCover(){var e=this;Object(r.a)({"success":function success(t){var a=t.tempFilePaths,n=t.tempFiles;console.log(a,n[0]),e.setState({"preViewUrl":a}),e.postImage(a[0])}})}},{"key":"changeConfig","value":function changeConfig(e){this.setState({"configType":e,"showConfig":!0})}},{"key":"choose","value":function choose(e,t){switch(e){case"reverse":this.setState({"devicePosition":t});break;case"beautify":this.setState({"beautify":t});break;default:this.setState({"filter":t})}}},{"key":"chooseGoods","value":function chooseGoods(){this.closeConfig(),i.a.navigateTo({"url":"/pages/member/live-store"})}},{"key":"closeConfig","value":function closeConfig(){this.setState({"showConfig":!1})}},{"key":"postImage","value":function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(e){var t=this;return regeneratorRuntime.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:Object(c.c)({"title":"上传中"}),Object(s.a)({"url":"https://sxt-s.oioos.com/api/h5app/wxapp/espier/upload","filePath":e,"name":"file","success":function success(e){Object(c.a)(),t.setState({"face_url":JSON.parse(e.data).data.url})}});case 2:case"end":return a.stop()}},_callee2,this)}));return function postImage(t){return e.apply(this,arguments)}}()},{"key":"confirmLive","value":function confirmLive(){var e=this,t=Object(o.b)("chooseList"),a={"name":this.state.name,"face_url":this.state.face_url,"products":JSON.stringify(t)};v.a.live.postConfig(a).then(function(t){Object(c.e)({"title":"设置成功"}),console.log(t.group_id),e.navigateToProgram(t.group_id)}).catch(function(e){Object(c.e)({"title":e.errMsg||"发生错误"})})}},{"key":"render","value":function render(){var e=this,t=this.state,a=t.name,o=t.showConfig,i=t.configType,l=t.devicePosition,r=t.beautify,c=t.filter,s=t.beautifyList,v=t.filterList,d=t.preViewUrl;return n.l.createElement(u.a,{"className":"live"},n.l.createElement(u.a,{"className":"iconfont icon-arrow-left nav","onClick":this.back,"style":{"top":this.state.top+"px"}}),n.l.createElement(u.a,{"className":"live-body"},n.l.createElement(b.a,{"contain-class":"live-body-bg","true-class":"true-content","renderTrue":n.l.createElement(u.a,null,n.l.createElement(u.a,{"className":"live-body-title"},"苏心淘直播"),n.l.createElement(u.a,{"className":"live-body-upload"},n.l.createElement(u.a,{"className":"left","onClick":this.changeCover.bind(this)},n.l.createElement(u.a,{"className":"iconfont icon-jia"}),n.l.createElement(u.a,{"className":"left-bottom"},n.l.createElement(u.a,{"className":"iconfont icon-fuzhi1"}),n.l.createElement(f.a,null,"更换封面")),d&&n.l.createElement(m.a,{"mode":"widthFix","className":"img","src":d})),n.l.createElement(u.a,{"className":"right"},n.l.createElement(p.a,{"type":"text","value":a,"className":"name-input","onInput":this.changeName.bind(this),"placeholder":"请输入直播间标题","placeholderStyle":"placeholder"})))),"renderHide":n.l.createElement(u.a,null,n.l.createElement(u.a,{"className":"live-body-title"},"苏心淘直播"),n.l.createElement(u.a,{"className":"live-body-upload"},n.l.createElement(u.a,{"className":"left","onClick":this.changeCover.bind(this)},n.l.createElement(u.a,{"className":"iconfont icon-jia"}),n.l.createElement(u.a,{"className":"left-bottom"},n.l.createElement(u.a,{"className":"iconfont icon-fuzhi1"}),n.l.createElement(f.a,null,"更换封面")),d&&n.l.createElement(m.a,{"mode":"widthFix","className":"img","src":d}))))})),n.l.createElement(u.a,{"className":"live-footer"},n.l.createElement(u.a,{"className":"live-footer-list"},n.l.createElement(u.a,{"className":"item","onClick":this.changeConfig.bind(this,"reverse")},n.l.createElement(u.a,{"className":"iconfont icon-reverse"}),n.l.createElement(f.a,null,"翻转")),n.l.createElement(u.a,{"className":"item","onClick":this.changeConfig.bind(this,"beautify")},n.l.createElement(u.a,{"className":"iconfont icon-beauty"}),n.l.createElement(f.a,null,"美颜")),n.l.createElement(u.a,{"className":"item","onClick":this.changeConfig.bind(this,"filter")},n.l.createElement(u.a,{"className":"iconfont icon-filt"}),n.l.createElement(f.a,null,"滤镜")),n.l.createElement(u.a,{"className":"item","onClick":this.chooseGoods.bind(this)},n.l.createElement(u.a,{"className":"iconfont icon-gouwucheman"}),n.l.createElement(f.a,null,"商品"))),n.l.createElement(u.a,{"className":"live-footer-begin","onClick":this.confirmLive.bind(this)},"开始直播")),o&&n.l.createElement(u.a,{"className":"live-config"},"reverse"===i&&n.l.createElement(u.a,{"className":"reverse-config"},n.l.createElement(u.a,{"className":"title"},"摄像头设置"),n.l.createElement(u.a,{"className":"item-list"},n.l.createElement(u.a,{"className":"config-item "+("front"===l?"selected":""),"onClick":this.choose.bind(this,"reverse","front")},"正面"),n.l.createElement(u.a,{"className":"config-item "+("back"===l?"selected":""),"onClick":this.choose.bind(this,"reverse","back")},"背面"))),"reverse"!==i&&n.l.createElement(u.a,{"className":"other-config"},n.l.createElement(u.a,{"className":"title"},"beautify"===i?"美颜":"滤镜"),n.l.createElement(h.a,{"scrollX":!0,"enableFlex":!0,"className":"scroll-contain"},"beautify"===i&&n.l.createElement(u.a,{"className":"item-list"},s.map(function(t,a){return n.l.createElement(u.a,{"className":"config-item "+(r===t?"selected":""),"onClick":e.choose.bind(e,"beautify",t)},t)})),"filter"===i&&n.l.createElement(u.a,{"className":"item-list"},v.map(function(t,a){return n.l.createElement(u.a,{"className":"config-item "+(c===t.value?"selected":""),"onClick":e.choose.bind(e,"filter",t.value)},t.label)})))),n.l.createElement(u.a,{"onClick":this.closeConfig.bind(this),"className":"config-close"},n.l.createElement(u.a,{"className":"iconfont icon-arrow-left"}))))}},{"key":"componentDidShow","value":function componentDidShow(){y(Live.prototype.__proto__||Object.getPrototypeOf(Live.prototype),"componentDidShow",this)&&y(Live.prototype.__proto__||Object.getPrototypeOf(Live.prototype),"componentDidShow",this).call(this)}},{"key":"componentDidHide","value":function componentDidHide(){y(Live.prototype.__proto__||Object.getPrototypeOf(Live.prototype),"componentDidHide",this)&&y(Live.prototype.__proto__||Object.getPrototypeOf(Live.prototype),"componentDidHide",this).call(this)}}]),Live}()}}]);