(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{"1008":function(e,t,n){"use strict";n.r(t);var a,i,o=n(3),s=n(358),r=n(4),l=n(357),c=n(582),u=n(461),p=n(462),m=n(472),f=n(5),h=n(906),d=n(905),g=n(465),v=n(460),b=n(546),y=n(463),w=n(474),E=n(458),_=n(368),N=(n(762),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var x=(i=a=function(e){function GiftListItem(e){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GiftListItem),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(GiftListItem.__proto__||Object.getPrototypeOf(GiftListItem)).call(this,e))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(GiftListItem,r["a"].Component),N(GiftListItem,[{"key":"componentDidMount","value":function componentDidMount(){}},{"key":"render","value":function render(){var e=this.props,t=e.index,n=e.info;e.onclick;return o.l.createElement(h.a,{"className":"gift"},o.l.createElement(h.a,{"className":"gift-title"},"礼包",t+1),o.l.createElement(h.a,{"className":"gift-code"},"电子码 ：",n.code),n.use_date&&o.l.createElement(h.a,{"className":"use-limit"},"使用日期 ：",n.use_date),o.l.createElement(h.a,{"className":"gift-status "+(1===n.is_use?"used":"unused"),"onClick":this.props.onclick.bind(this,t)},1===n.is_use?"已使用":"去使用"))}}]),GiftListItem}(),a.defaultprops={"info":null,"index":0,"onclick":function onclick(){}},i),k=n(9),O=n(34);n(764);n.d(t,"default",function(){return P});var j=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),C=function get(e,t,n){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,t);if(void 0===a){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in a)return a.value;var o=a.get;return void 0!==o?o.call(n):void 0};function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(a,i){try{var o=t[a](i),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){step("next",e)},function(e){step("throw",e)});e(s)}("next")})}}var P=function(e){function Vip(e){!function vip_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Vip);var t=function vip_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Vip.__proto__||Object.getPrototypeOf(Vip)).call(this,e));return t.handleClickBuy=function(e){e===t.state.grade_name?Object(s.e)({"title":"您已激活！","duration":2e3}):"钻石会员"===e?r.a.navigateTo({"url":"/pages/index"}):r.a.navigateTo({"url":"/pages/vip/vipgrades?grade_name="+e})},t.handleClickTransform=function(){console.log("兑换中")},t.handleClickLook=function(){r.a.navigateTo({"url":"/pages/index"})},t.handleChange=function(e){var n=e.detail;t.setState({"curIndex":n.current})},t.handleUse=function(e){1!==t.state.giftList[e].is_use&&t.setState({"showFeature":!0,"giftIndex":e},function(){t.fetch(e,function(){t.drawImg()})})},t.handleHide=function(){t.setState({"showFeature":!1})},t.handleSaveImg=function(){Object(l.m)({"filePath":t.state.path,"success":function success(){Object(s.e)({"title":"保存成功","icon":"success","duration":1500})},"fail":function fail(){Object(s.e)({"title":"保存失败","icon":"none","duration":1500})},"complete":function complete(){t.setState({"showCanvas":!t.state.showCanvas})}})},t.handleCopyCode=function(){Object(c.a)({"data":t.state.giftList[t.state.giftIndex].code.toString(),"success":function success(e){console.log(e),Object(s.e)({"title":"复制成功","icon":"success","duration":1500})},"fail":function fail(e){Object(s.e)({"title":"复制失败，稍后重试","icon":"none","duration":1500})}})},t.handleShareCode=function(){},t.drawImg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=Object(l.f)(),a=(new Date).getTime();n.writeFile({"filePath":r.a.env.USER_DATA_PATH+"/pic"+a+".png","data":t.state.res.qrcode_url.slice(22),"encoding":"base64","success":function success(n){var i=t.width/375*187.5;console.log("success");var o=Object(u.a)("own-canvas",t);o.setFontSize(14);var s=o.measureText("您的专属激活码");o.fillText("您的专属激活码",.5*i-s.width/2,20),o.setFontSize(20);var l=o.measureText(t.state.giftList[t.state.giftIndex].code);o.fillText(t.state.giftList[t.state.giftIndex].code,.5*i-l.width/2,50),o.setFontSize(14),o.stroke(),o.drawImage(r.a.env.USER_DATA_PATH+"/pic"+a+".png",.2*i,67.2,.6*i,.6*i),o.setFillStyle("#c0534e"),o.rect((i-110)/2,204,110,20),o.fill(),o.beginPath(),o.arc((i-110)/2,214,10,Math.PI/2-1,1.5*Math.PI+1,!1),o.closePath(),o.arc((i+110)/2,214,10,-Math.PI/2-1,1.5*Math.PI+1,!1),o.closePath(),o.fill(),o.setFillStyle("white"),o.setFontSize(10);var c=o.measureText("长按小程序码进入苏心淘");o.fillText("长按小程序码进入苏心淘",.5*i-c.width/2,217),o.draw(!1,function(){Object(p.a)({"x":0,"y":0,"width":i,"height":240,"destWidth":i,"destHeight":240,"canvasId":"own-canvas","success":function success(n){t.setState({"path":n.tempFilePath},function(){e()})}},t)})}})},t.handleCancelImg=function(){t.setState({"showImage":!1})},t.showToolBar=function(){t.setState({"showToolBar":!0})},t.hideToolBar=function(){setTimeout(function(){t.setState({"showToolBar":!1})},2500)},t.state={"titleList":["钻石会员","至尊会员","王者身份"],"curIndex":0,"giftIndex":null,"grade_name":"","giftList":[],"showFeature":!1,"res":null,"showCanvas":!1,"path":null,"showImage":!1,"showToolBar":!1,"width":Object(m.b)().screenWidth},Object(m.b)().screenWidth,t.couponList=[{"title":"50元优惠券","url":O.d+"/50元.png"},{"title":"30元优惠券","url":O.d+"/30元.png"},{"title":"20元优惠券","url":O.d+"/20元.png"},{"title":"10元优惠券","url":O.d+"/10元.png"},{"title":"5元优惠券","url":O.d+"/5元.png"}],t}return function vip_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Vip,r["a"].Component),j(Vip,[{"key":"componentDidMount","value":function componentDidMount(){var e=Object(m.b)();this.dpr=e.pixelRatio,this.width=e.screenWidth,this.height=e.screenHeight,this.getList(),this.setState({"grade_name":this.$router.params.grade_name})}},{"key":"getList","value":function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var e;return regeneratorRuntime.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.a.member.getGiftList({"page":1});case 2:e=t.sent,this.setState({"giftList":e.list});case 4:case"end":return t.stop()}},_callee,this)}));return function getList(){return e.apply(this,arguments)}}()},{"key":"fetch","value":function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(e,t){var n;return regeneratorRuntime.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return Object(s.c)({"title":"获取礼包二维码中"}),a.next=3,k.a.member.inviteCode(this.state.giftList[e].code);case 3:n=a.sent,Object(s.a)(),this.setState({"res":n},function(){t()});case 6:case"end":return a.stop()}},_callee2,this)}));return function fetch(t,n){return e.apply(this,arguments)}}()},{"key":"onShareAppMessage","value":function onShareAppMessage(e){var t=Object(f.b)("userinfo");return{"title":"免费成为至尊会员","path":"/pages/member/index?inviteCode="+this.state.giftList[this.state.giftIndex].code.toString()+"&uid="+t.user_card_code,"imageUrl":this.state.path}}},{"key":"handleShowDec","value":function handleShowDec(){var e=this;this.drawImg(function(){e.setState({"showImage":!0,"showFeature":!e.state.showFeature})})}},{"key":"handleRule","value":function handleRule(){r.a.navigateTo({"url":"/pages/member/vip-rule"})}},{"key":"render","value":function render(){var e=this,t=this.state,n=t.width,a=(t.showToolBar,t.titleList),i=t.curIndex,s=t.grade_name,r=t.giftList,l=t.showFeature;t.giftIndex,t.res,t.showCanvas;return o.l.createElement(h.a,{"className":"vip-view","onTouchStart":this.showToolBar,"onTouchEnd":this.hideToolBar},o.l.createElement(h.a,{"style":"display:"+(this.state.showImage?"block":"none"),"className":"vip-fixed"}),o.l.createElement(h.a,{"style":"display:"+(this.state.showImage?"block":"none"),"className":"img-container"},o.l.createElement(d.a,{"style":"width:"+375*n/750+"px;height:"+480*n/750+"px","showMenuByLongpress":!0,"src":this.state.path}),o.l.createElement(h.a,{"className":"img-controll","onClick":this.handleSaveImg},"保存到相册"),o.l.createElement(h.a,{"className":"close","onClick":this.handleCancelImg},"X")),o.l.createElement(h.a,{"className":"vip-fixed","style":{"display":l?"block":"none"}}),o.l.createElement(g.a,{"canvasId":"own-canvas","className":"own-canvas","style":"width:"+375*n/750+"px;height:"+480*n/750+"px;display:"+(l?"block":"none"),"ref":function ref(t){e["__taroref_own-canvas"]=t}}),o.l.createElement(h.a,{"style":{"display":l?"flex":"none"},"className":"vip-fixed-bottom"},o.l.createElement(h.a,{"className":"vip-fixed-bottom-container"},o.l.createElement(h.a,{"className":"message-item"},o.l.createElement(v.a,{"className":"iconfont icon-fenxiang"}),o.l.createElement(b.a,{"openType":"share"},"分享给好友")),o.l.createElement(h.a,{"className":"message-item","onClick":this.handleCopyCode},o.l.createElement(v.a,{"className":"iconfont icon-fuzhi"}),o.l.createElement(b.a,{"className":"item-button"},"复制激活码")),o.l.createElement(h.a,{"className":"message-item","onClick":this.handleShowDec},o.l.createElement(v.a,{"className":"iconfont icon-copy"}),o.l.createElement(b.a,{"className":"item-button"},"保存图片"))),o.l.createElement(h.a,{"className":"vip-fixed-bottom-controll","onClick":this.handleHide},"取消")),o.l.createElement(_.a,{"title":"权益中心"}),o.l.createElement(h.a,{"className":"vip-header"},o.l.createElement(h.a,{"className":"vip"},o.l.createElement(h.a,{"className":"vip-sort-container"},o.l.createElement(h.a,{"className":"vip-sort-title"},"- ",a[i]," -"),o.l.createElement(h.a,{"className":"vip-sort-look","onClick":this.handleRule},"规则查看 >")),o.l.createElement(h.a,{"className":"vip-feature"},o.l.createElement(h.a,null,o.l.createElement(y.a,{"autoplay":3e3,"className":"vip-card-swiper","current":i,"indicatorDots":!0,"nextMargin":130*n/750+"px","previousMargin":130*n/750+"px","onChange":this.handleChange},o.l.createElement(y.b,{"className":"swiper-item"},o.l.createElement(d.a,{"className":"item-img","src":O.d+"/zuanshi.png"})),o.l.createElement(y.b,{"className":"swiper-item"},o.l.createElement(d.a,{"className":"item-img","src":O.d+"/zhizun.png"})),o.l.createElement(y.b,{"className":"swiper-item"},o.l.createElement(d.a,{"className":"item-img","src":O.d+"/wangzhe.png"})))))),o.l.createElement(h.a,{"className":"vip-similar-"+i},0===i&&o.l.createElement(d.a,{"src":O.d+"/zsqy.jpg","mode":"widthFix","className":"img"}),1===i&&o.l.createElement(d.a,{"src":O.d+"/zzqy.jpg","mode":"widthFix","className":"img"}),2===i&&o.l.createElement(d.a,{"src":O.d+"/wzqy.jpg","mode":"widthFix","className":"img"})),o.l.createElement(h.a,{"className":"vip-own"},o.l.createElement(h.a,{"className":"vip-0-title"},"- 权益专享 -"),o.l.createElement(h.a,null,0!==i&&o.l.createElement(h.a,{"className":"vip-2-content"},o.l.createElement(h.a,{"className":"vip-2-content-title"},"300 元优惠券 :"),o.l.createElement(h.a,{"className":"vip-2-content-subtitle"},o.l.createElement(w.a,{"className":"icon"},"i"),"激活会员后可用于苏心淘使用"),o.l.createElement(h.a,null,o.l.createElement(E.a,{"scrollX":!0,"enableFlex":!0,"className":"scroll-coupon"},this.couponList.map(function(e,t){return o.l.createElement(h.a,{"className":"coupon-item"},o.l.createElement(d.a,{"src":e.url,"className":"img"}),o.l.createElement(h.a,{"className":"coupon-dec"},e.title))}))))),o.l.createElement(h.a,{"className":"quanyi-1"},0===i&&o.l.createElement(d.a,{"src":O.d+"/zsqy1.jpg","mode":"widthFix","className":"img"}),1===i&&o.l.createElement(d.a,{"src":O.d+"/zzqy1.jpg","mode":"widthFix","className":"img"}),2===i&&o.l.createElement(d.a,{"src":O.d+"/wzqy1.jpg","mode":"widthFix","className":"img"})),o.l.createElement(h.a,null,"王者身份"===a[i]&&"王者身份"===s&&o.l.createElement(h.a,null,o.l.createElement(h.a,{"className":"vip-2-title"},"- 礼包码 -"),o.l.createElement(h.a,null,o.l.createElement(E.a,{"scrollY":!0,"onScrollToLower":this.nextPage,"className":"gift-list"},r.map(function(t,n){return o.l.createElement(h.a,{"className":"gift-list gift-list-"+n},o.l.createElement(x,{"info":t,"index":n,"onclick":e.handleUse}))}))))),o.l.createElement(h.a,{"className":"button-bottom"},o.l.createElement(h.a,{"className":"vip-1-button"},o.l.createElement(h.a,{"className":"vip-1-button-dec"},o.l.createElement(w.a,{"className":"vip-1-button-dec-1"},a[i]),0===i&&o.l.createElement(w.a,{"className":"vip-1-button-dec-2"},"任意消费即可激活"),1===i&&o.l.createElement(w.a,{"className":"vip-1-button-dec-2"},"低至￥",o.l.createElement(w.a,{"className":"vip-1-button-dec-3"},"0.8"),"元/每天"),2===i&&o.l.createElement(w.a,{"className":"vip-1-button-dec-2"},"享受返佣")),o.l.createElement(h.a,{"className":"vip-1-button-click","onClick":this.handleClickBuy.bind(this,a[i])},s===a[i]?"已付款":1===i?"支付/兑换":0===i?"去下单":"支付"))))))}},{"key":"componentDidShow","value":function componentDidShow(){C(Vip.prototype.__proto__||Object.getPrototypeOf(Vip.prototype),"componentDidShow",this)&&C(Vip.prototype.__proto__||Object.getPrototypeOf(Vip.prototype),"componentDidShow",this).call(this)}},{"key":"componentDidHide","value":function componentDidHide(){C(Vip.prototype.__proto__||Object.getPrototypeOf(Vip.prototype),"componentDidHide",this)&&C(Vip.prototype.__proto__||Object.getPrototypeOf(Vip.prototype),"componentDidHide",this).call(this)}}]),Vip}()},"368":function(e,t,n){"use strict";n.d(t,"a",function(){return p});var a,i,o=n(3),s=n(4),r=n(472),l=n(5),c=n(906),u=(n(377),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var p=(i=a=function(e){function NavGap(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,NavGap);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(NavGap.__proto__||Object.getPrototypeOf(NavGap)).call(this,e));return t.handleIconClick=function(){console.log("kakakakk"),s.a.navigateBack()},t.props=e,t.state={"showIcon":!1,"navBar":0},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(NavGap,s["a"].Component),u(NavGap,[{"key":"componentDidMount","value":function componentDidMount(){var e=s.a.getCurrentPages(),t=null;try{t=Object(r.b)(),this.setState({"navBar":t.statusBarHeight})}catch(e){console.log(e)}this.setState({"showIcon":!/(index|category\/index|recommend\/list|cart\/espier-index|member\/index)(.)*/.test(e[e.length-1].route)})}},{"key":"render","value":function render(){var e=this.props,t=e.title,n=(e.home,this.state.showIcon),a=Object(l.b)("top");return o.l.createElement(c.a,{"className":"nav-gap-container","style":{"background":this.props.bg?this.props.bg:"","color":this.props.cl?this.props.cl:"black"}},o.l.createElement(c.a,{"className":"iconfont icon-arrow-left","onClick":this.handleIconClick.bind(this),"style":{"top":a+"px","display":n?"block":"none"}}),o.l.createElement(c.a,{"style":{"top":a+"px"},"className":"gap-title"},t))}}]),NavGap}(),a.options={"addGlobalClass":!0},i)},"377":function(e,t,n){},"762":function(e,t,n){},"764":function(e,t,n){}}]);