"use strict";var _createReducer;Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};exports.getTotalCount=getTotalCount,exports.getTotalPrice=getTotalPrice,exports.getSelectedCart=getSelectedCart;var _index=require("../npm/redux-create-reducer/index.js");function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function walkCart(e,t){e.list.forEach(function(e){e.list.forEach(t)})}var initState={list:[],cartIds:[],fastbuy:null,coupon:null,selection:[]},cart=(0,_index.createReducer)(initState,(_defineProperty(_createReducer={},"cart/checkout",function(e,t){var r=t.payload;return _extends({},e,{checkoutItem:r})}),_defineProperty(_createReducer,"cart/fastbuy",function(e,t){var r=t.payload,n=r.item,a=r.num;return _extends({},e,{fastbuy:_extends({},n,{num:void 0===a?1:a})})}),_defineProperty(_createReducer,"cart/updateNum",function(e,t){var r=t.payload,n=r.cart_id,a=r.num;walkCart(e,function(e){e.cart_id===n&&(e.num=a)});var c=[].concat(_toConsumableArray(e.list));return _extends({},e,{list:c})}),_defineProperty(_createReducer,"cart/update",function(e,t){var r=t.payload,n=[];return walkCart({list:r},function(e){n.push(e.cart_id)}),_extends({},e,{list:r,cartIds:n})}),_defineProperty(_createReducer,"cart/clearFastbuy",function(e){return _extends({},e,{fastbuy:null})}),_defineProperty(_createReducer,"cart/clear",function(e){return _extends({},e,initState)}),_defineProperty(_createReducer,"cart/selection",function(e,t){var r=t.payload;return _extends({},e,{selection:r})}),_defineProperty(_createReducer,"cart/changeCoupon",function(e,t){var r=t.payload;return _extends({},e,{coupon:r})}),_createReducer));function getTotalCount(t,r){var n=0;return walkCart(t,function(e){(r||t.selection.includes(e.cart_id))&&(n+=+e.num)}),n}function getTotalPrice(t){var r=0;return walkCart(t,function(e){t.selection.includes(e.cart_id)&&(r+=+e.price*+e.num)}),r.toFixed(2)}function getSelectedCart(t){return t.list.filter(function(e){return t.selection.includes(e.item_id)})}exports.default=cart;