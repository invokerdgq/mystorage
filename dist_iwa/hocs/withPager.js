"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function _asyncToGenerator(e){return function(){var s=e.apply(this,arguments);return new Promise(function(o,i){return function t(e,n){try{var r=s[e](n),a=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(a).then(function(e){t("next",e)},function(e){t("throw",e)});o(a)}("next")})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function withPager(t){var e,p;return e=function(e){function u(e){_classCallCheck(this,u);var t=_possibleConstructorReturn(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));p.call(t);var n=e||{},r=n.pageSize,a=void 0===r?10:r,o=n.pageNo,i=void 0===o?0:o,s=n.pageTotal,c={hasNext:!0,isLoading:!1,total:void 0===s?0:s,page_no:i,page_size:a};return t.state.page=c,t}return _inherits(u,t),_createClass(u,[{key:"resetPage",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t=_extends({},this.state.page||{},{page_no:0,total:0,isLoading:!1,hasNext:!0});this.setState({page:t},e)}}]),u}(),p=function(){var s=this;this.nextPage=_asyncToGenerator(getApp().regeneratorRuntime.mark(function e(){var t,n,r,a,o,i;return getApp().regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=s.state.page).hasNext||t.isLoading)return e.abrupt("return");e.next=3;break;case 3:return t.isLoading=!0,s.setState({page:t}),n=t.page_no,r=t.page_size,a=n+1,e.next=9,s.fetch({page_no:a,page_size:r});case 9:o=e.sent,(!(i=o.total)||a>=Math.ceil(+i/r))&&(t.hasNext=!1),s.setState({page:_extends({},t,{total:i,page_no:a,isLoading:!1})});case 13:case"end":return e.stop()}},e,s)}))},e}exports.default=withPager;